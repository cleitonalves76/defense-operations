Splunk: Configurando Laboratório

Na VM com Linux, acesse: https://www.splunk.com/
Botão: Trials & Downloads
Crie uma conta e valide via e-mail

Quando logar, acessar link: Free Trials and Downloads page

Splunk Enterprise -> Get My Free Trial

Quando terminar o download do arquivo. Instalar Splunk Enterprise 9.x via Terminal

sudo tar xvzf splunk-9<xx>.tgz -C /opt

cd /opt/splunk/bin

Splunk CLI commands
  ./splunk start
  ./splunk stop
  ./splunk restart
  ./splunk help

sudo ./splunk start --accept-license

Definir credencial:
  administrator username:
  password:

Acessar interface Web:
  http://127.0.0.1:8000


----
Splunk: Iniciando os trabalhos
----

Conforme a documentação do Splunk, quando dados são adicionados ao Splunk, eles são processados ​​e transformados em uma série de eventos individuais.
As fontes de dados podem ser logs de eventos, logs de sites, logs de firewall, etc. As fontes de dados são agrupadas em categorias. 
  https://docs.splunk.com/Documentation/Splunk/9.4.1/SearchTutorial/AboutgettingdataintoSplunk

- Primeira parte: Upload do arquivo de dados compactado

Carregue os dados tutorialdata.zip
O arquivo deve permanecer compactado para que seja carregado com sucesso. 
As informaçoes inclusas no arquivo compactado são: access.log files, secure.log files e vendor_sales.log de mail servers e web accounts, coletados da loja online Buttercup Games - Exemplo da Splunk

Clique Settings > Add Data
Clique em Upload
Selecione tutorialdata.zip e clique em Open
Input Settings
  - Segment in path, digite 1
Review
Done

Para ver os dados no aplicativo Search, clique em Start Searching. O aplicativo Search abre e uma pesquisa é executada automaticamente na fonte de dados do tutorial.
Digite na pesquisa: source="tutorialdata.zip:*"
Assim que você confirmar a ingestão dos dados, clique no logo Splunk para retornar a página inicial.

- Segunda parte: Usando Search App do Splunk

Na página inicial do Splunk, clique em Search & Reporting no painel Apps.
Em New Seach: source="tutorialdata.zip:./www1/access.log"

-- Especificando intervalos de tempo: Search views

Restringir ou filtrar seus critérios de pesquisa usando um intervalo de tempo é a maneira mais fácil e eficaz de otimizar suas pesquisas.
Você pode usar intervalos de tempo para solucionar um problema, se souber o período aproximado em que o problema ocorreu. Restrinja o período de sua pesquisa a esse período. Por exemplo, para investigar um incidente que ocorreu em algum momento na última hora, você pode usar o período padrão Últimas 24 horas, mas uma opção melhor é Últimos 60 minutos.

Vamos explorar os dados da loja online Buttercup Games (case Splunk) usando os diferentes intervalos de tempo.
Para iniciar uma nova pesquisa, clique em Pesquisar na barra de aplicativos, e digite buttercupgames na barra de pesquisa e pressione Enter.

-- Intervalos de tempo predefinidos

O seletor de intervalo de tempo tem muitos intervalos de tempo predefinidos que você pode selecionar.
A opção Predefinições contém intervalos de tempo em tempo real, relativo e outros.

-- Pesquisas básicas e resultados de pesquisa

Como os dados são da loja online Buttercup Games, que vende jogos e outros itens relacionados, como camisetas.

Usando o Assistente de Pesquisa, você pesquisará principalmente os logs de acesso à web do Apache e correlacionará os logs de acesso com os logs de vendas do fornecedor.

Clique em Pesquisar na barra de aplicativos para iniciar uma nova pesquisa, e digite buttercup
Quando você digita algumas letras na barra de pesquisa, o Assistente de Pesquisa mostra os termos em seus dados que correspondem às letras que você digita.
Digite categoryid na barra de pesquisa. 
Exemplos de pesquisas: 
  "categoryid=accessories"
  buttercupgames (error OR fail* OR severe)
    O caractere asterisco (*) é usado como um caractere curinga para corresponder a fail, failure, failed, failing e assim por diante.

-- Campos para pesquisar

Um campo é um valor com uma posição fixa e delimitada em uma linha
  Exemplos de campos são clientip para endereços IP acessando seu servidor Web, _time para o registro de data e hora de um evento e host para o nome de domínio de um servidor.

-- Pesquisar com campos
Ao pesquisar por campos, você usa a sintaxe field_name=field_value.
  - Os nomes de campo diferenciam maiúsculas de minúsculas, mas os valores de campo não.
  - Você pode usar curingas em valores de campo.
  - Aspas são necessárias quando os valores de campo incluem espaços.

Para pesquisar no campo sourcetype por quaisquer valores que comecem com access_, execute a seguinte pesquisa.
  sourcetype=access_*

