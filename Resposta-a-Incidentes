Exerc√≠cios ‚Äì Resposta a Incidentes de Seguran√ßa (NIST 800-61)

Publica√ß√£o dispon√≠vel em: <https://csrc.nist.gov/pubs/sp/800/61/r2/final>

**************
Parte 1 ‚Äì Eita... um incidente
**************
Importante: Iniciar quando o professor autorizar, blz

1. Se acontecer um incidente de seguran√ßa?
  https://www.menti.com/alwnqm5j6kit

**************
Parte 2 ‚Äì Bora pensar
**************
Importante: Iniciar quando o professor autorizar, blz

1. Perguntinhas b√°sicas para um desafio.
  https://www.menti.com/al49nogfs9gq

**************
Parte 3 ‚Äì Exerc√≠cios Te√≥ricos
**************

1. Conceitos Fundamentais
1.1 Qual a principal diferen√ßa entre evento e incidente de seguran√ßa?
1.2 Cite tr√™s exemplos de eventos que n√£o s√£o incidentes.
1.3 Explique como um evento pode evoluir para um incidente.

2. Tr√≠ade CIA
2.1 O que significam Confidencialidade, Integridade e Disponibilidade?
2.2 D√™ um exemplo de incidente que afete cada um dos tr√™s pilares.

3. Ciclo de Vida de Resposta a Incidentes
3.1 Quais s√£o as quatro fases definidas pelo NIST?
3.2 Qual fase √© considerada a mais importante e por qu√™?
3.3 Em qual fase ocorre a cria√ß√£o de pol√≠ticas e treinamentos?
3.4 O que diferencia conten√ß√£o de erradica√ß√£o?

4. Detec√ß√£o e An√°lise
4.1 Cite ao menos quatro fontes de detec√ß√£o de incidentes.
4.2 O que √© um falso positivo?
4.3 Por que a qualidade dos logs √© cr√≠tica?

5. Estrutura Organizacional
5.1 Diferencie equipe centralizada de equipe distribu√≠da.
5.2 Qual o papel do jur√≠dico em um incidente de seguran√ßa?
5.3 Quando √© recomendado terceirizar o SOC?

6. Comunica√ß√£o
6.1 Por que √© importante ter um porta-voz definido?
6.2 Quais riscos existem ao divulgar detalhes t√©cnicos de um incidente?

7. M√©tricas
7.1 O que √© MTTD?
7.2 O que √© MTTR?
7.3 Por que medir tempo de recupera√ß√£o √© relevante para o neg√≥cio?

**************
Parte 4 ‚Äì Exerc√≠cios Pr√°ticos (Simula√ß√µes)
**************

Exerc√≠cio 1 ‚Äì An√°lise de Incidente Simples
Cen√°rio: √Äs 02:30 da manh√£, o servidor registra 500 tentativas de login falhas vindas do mesmo IP.

Perguntas:
1.	Isso √© evento ou incidente?
2.	Qual fase do ciclo est√° sendo aplicada?
3.	Que a√ß√µes imediatas voc√™ tomaria?
4.	Que ferramentas ajudariam na an√°lise?

Exerc√≠cio 2 ‚Äì Phishing
Cen√°rio: V√°rios funcion√°rios relatam e-mails pedindo redefini√ß√£o de senha com um link externo.
Tarefas:
‚Ä¢	Classifique a severidade (baixo/m√©dio/alto/cr√≠tico). 
‚Ä¢	Defina a√ß√µes de conten√ß√£o.
‚Ä¢	Liste comunica√ß√µes internas necess√°rias.
‚Ä¢	Indique a√ß√µes de preven√ß√£o futura.

Exerc√≠cio 3 ‚Äì Vazamento de Dados
Cen√°rio: Uma planilha com dados de clientes foi compartilhada publicamente por engano.
Perguntas:
1.	Qual pilar da CIA foi afetado?
2.	Quem deve ser acionado?
3.	Que fase do NIST √© cr√≠tica nesse momento?
4.	Que medidas de recupera√ß√£o s√£o necess√°rias?

Exerc√≠cio 4 ‚Äì Ransomware
Cen√°rio: Computadores come√ßam a exibir mensagem de resgate.
Atividades:
‚Ä¢	Definir conten√ß√£o imediata.
‚Ä¢	Listar passos de erradica√ß√£o.
‚Ä¢	Definir plano de recupera√ß√£o.
‚Ä¢	Identificar li√ß√µes aprendidas.

Exerc√≠cio Pr√°tico 5 ‚Äì Estrutura de Equipe
Situa√ß√£o: Uma empresa pequena sofre ataques frequentes e n√£o possui equipe dedicada.
Tarefa:
Propor:
‚Ä¢	modelo de equipe adequado
‚Ä¢	ferramentas m√≠nimas
‚Ä¢	pol√≠ticas iniciais
‚Ä¢	treinamento essencial

**************
Parte 5 ‚Äì Exerc√≠cio de Planejamento
**************

Desafio: Monte um mini Plano de Resposta a Incidentes contendo:
‚Ä¢	Defini√ß√£o de incidente
‚Ä¢	Lista de contatos
‚Ä¢	Ferramentas dispon√≠veis
‚Ä¢	Fluxo de comunica√ß√£o
‚Ä¢	Checklist de resposta
‚Ä¢	M√©tricas de sucesso

**************
Parte 6 ‚Äì Exerc√≠cio de Reflex√£o
**************

1.	O que aconteceria se a fase de p√≥s-incidente fosse ignorada?
2.	Qual o maior risco de n√£o documentar incidentes?
3.	Seguran√ßa √© mais t√©cnica ou mais processual? Justifique.


**************
Parte 7	- Que tal simular incidentes ?
**************

Usar Python como ferramenta de simula√ß√£o √© excelente para treinar resposta a incidentes, porque permite trabalhar com logs, detec√ß√£o, an√°lise e automa√ß√£o, que s√£o pontos centrais do NIST 800-61.
Abaixo est√£o exerc√≠cios pr√°ticos guiados, que voc√™ pode rodar em Python.

Exerc√≠cio 1 ‚Äì Detec√ß√£o de For√ßa Bruta em Logs
Objetivo: Identificar m√∫ltiplas tentativas de login falhas a partir de um arquivo de log.
Cen√°rio: Voc√™ recebeu um log de autentica√ß√£o e precisa detectar poss√≠veis ataques.

Passo 1 ‚Äì Criar um log simulado

logs = [
    "2026-01-01 10:00:01 login_fail 192.168.0.10",
    "2026-01-01 10:00:05 login_fail 192.168.0.10",
    "2026-01-01 10:00:07 login_success 192.168.0.20",
    "2026-01-01 10:00:09 login_fail 192.168.0.10",
    "2026-01-01 10:00:12 login_fail 192.168.0.10",
]

Passo 2 ‚Äì Detectar IP suspeito

from collections import Counter

ips = [log.split()[-1] for log in logs if "login_fail" in log]
contagem = Counter(ips)

for ip, tentativas in contagem.items():
    if tentativas >= 3:
        print(f"ALERTA: Poss√≠vel for√ßa bruta do IP {ip}")
Aprendizado NIST
‚Ä¢	Fase: Detec√ß√£o e An√°lise
‚Ä¢	Correla√ß√£o de eventos
‚Ä¢	Identifica√ß√£o de padr√µes
________________________________________
8	Exerc√≠cio 2 ‚Äì Identificar Malware por Extens√£o de Arquivo
Objetivo
Detectar arquivos suspeitos em uma lista de downloads.
arquivos = [
    "relatorio.pdf",
    "planilha.xlsx",
    "foto.jpg",
    "invoice.exe",
    "atualizacao.scr"
]

suspeitos = [a for a in arquivos if a.endswith((".exe", ".scr", ".bat"))]

print("Arquivos suspeitos encontrados:")
for s in suspeitos:
    print(s)
Aprendizado NIST
‚Ä¢	Fase: Detec√ß√£o
‚Ä¢	An√°lise de comportamento suspeito
‚Ä¢	Classifica√ß√£o de severidade
________________________________________
9	Exerc√≠cio 3 ‚Äì Simula√ß√£o de Vazamento de Dados
Objetivo
Detectar acessos externos a arquivos confidenciais.
acessos = [
    {"usuario": "joao", "arquivo": "clientes.xlsx", "origem": "interna"},
    {"usuario": "maria", "arquivo": "financeiro.xlsx", "origem": "externa"},
    {"usuario": "ana", "arquivo": "publico.pdf", "origem": "externa"},
]

for a in acessos:
    if a["origem"] == "externa" and "xlsx" in a["arquivo"]:
        print("Poss√≠vel vazamento:", a)
Aprendizado
‚Ä¢	Pilar afetado: Confidencialidade
‚Ä¢	Fase: Conten√ß√£o
‚Ä¢	Import√¢ncia de classifica√ß√£o de dados
________________________________________
10	Exerc√≠cio 4 ‚Äì M√©tricas de Incidentes (MTTD / MTTR)
Objetivo
Calcular tempo m√©dio de detec√ß√£o e resposta.
incidentes = [
    {"detectado": 2, "resolvido": 6},
    {"detectado": 1, "resolvido": 4},
    {"detectado": 3, "resolvido": 8},
]

mttd = sum(i["detectado"] for i in incidentes) / len(incidentes)
mttr = sum(i["resolvido"] for i in incidentes) / len(incidentes)

print("MTTD:", mttd)
print("MTTR:", mttr)
Aprendizado
‚Ä¢	Fase: P√≥s-Incidente
‚Ä¢	Indicadores de maturidade
‚Ä¢	Justificativa de investimento
________________________________________
11	Exerc√≠cio 5 ‚Äì Simula√ß√£o de Resposta Automatizada
Objetivo
Criar uma ‚Äúa√ß√£o de conten√ß√£o‚Äù autom√°tica.
ip_suspeito = "192.168.0.10"

def bloquear_ip(ip):
    print(f"Firewall: IP {ip} bloqueado com sucesso.")

bloquear_ip(ip_suspeito)
Aprendizado
‚Ä¢	Fase: Conten√ß√£o
‚Ä¢	Automa√ß√£o de resposta
‚Ä¢	Redu√ß√£o de tempo de rea√ß√£o
________________________________________
12	N√≠vel Avan√ßado (Ideias)
Voc√™ pode evoluir para:
‚Ä¢	Ler arquivos .log reais
‚Ä¢	Usar pandas para an√°lise de grandes volumes
‚Ä¢	Criar dashboard simples
‚Ä¢	Simular SIEM b√°sico
‚Ä¢	Alertas por e-mail
‚Ä¢	Detec√ß√£o de anomalias com scikit-learn
________________________________________
Esses exerc√≠cios treinam exatamente o que o NIST enfatiza:
‚Ä¢	Detec√ß√£o r√°pida
‚Ä¢	An√°lise estruturada
‚Ä¢	Conten√ß√£o eficiente
‚Ä¢	Medi√ß√£o de desempenho
‚Ä¢	Automa√ß√£o de resposta
√â praticamente um mini-laborat√≥rio de SOC em Python.


Perfeito ‚Äî vamos ‚Äúsubir o n√≠vel‚Äù üöÄ
A ideia agora √© sair de exemplos simples e chegar em algo mais pr√≥ximo de um mini-SOC em Python: leitura de arquivos reais, an√°lise com pandas, gera√ß√£o de alertas e relat√≥rios.
________________________________________
13	Exerc√≠cio 6 ‚Äì Ler um Arquivo de Log Real
Objetivo
Analisar um .log externo em vez de lista fixa.
Exemplo de log (auth.log)
2026-02-01 10:00:01 login_fail 192.168.0.10
2026-02-01 10:00:03 login_fail 192.168.0.10
2026-02-01 10:00:08 login_success 192.168.0.20
C√≥digo
from collections import Counter

with open("auth.log", "r") as f:
    linhas = f.readlines()

ips_falha = [l.split()[-1] for l in linhas if "login_fail" in l]
contagem = Counter(ips_falha)

for ip, qtd in contagem.items():
    if qtd >= 5:
        print(f"[ALERTA] For√ßa bruta detectada: {ip} ({qtd} tentativas)")
NIST: Detec√ß√£o e An√°lise + Correla√ß√£o de Eventos.
________________________________________
14	Exerc√≠cio 7 ‚Äì An√°lise com Pandas (Volume Grande)
Objetivo
Trabalhar com muitos registros.
import pandas as pd

df = pd.read_csv("logs.csv")  
# colunas: data, evento, ip

falhas = df[df["evento"] == "login_fail"]
top_ips = falhas["ip"].value_counts().head(5)

print("IPs mais suspeitos:")
print(top_ips)
Aprendizado: prioriza√ß√£o, estat√≠stica b√°sica, vis√£o de tend√™ncia.
________________________________________
15	Exerc√≠cio 8 ‚Äì Classifica√ß√£o de Severidade
Objetivo
Transformar eventos em n√≠veis de risco.
def severidade(evento):
    if evento == "ransomware":
        return "CR√çTICO"
    if evento == "vazamento_dados":
        return "ALTO"
    if evento == "phishing":
        return "M√âDIO"
    return "BAIXO"

eventos = ["phishing", "login_fail", "ransomware"]

for e in eventos:
    print(e, "->", severidade(e))
NIST: Prioriza√ß√£o de incidentes.
________________________________________
16	Exerc√≠cio 9 ‚Äì Alerta Autom√°tico (Simula√ß√£o de SIEM)
Objetivo
Gerar alerta quando condi√ß√£o √© atingida.
def alerta(msg):
    print(f"[ALERTA SOC] {msg}")

tentativas = 12

if tentativas > 10:
    alerta("Poss√≠vel ataque de for√ßa bruta detectado")
Voc√™ pode evoluir para:
‚Ä¢	enviar e-mail (smtplib)
‚Ä¢	webhook
‚Ä¢	Telegram/Slack bot
________________________________________
17	Exerc√≠cio 10 ‚Äì Dashboard Simples de Incidentes
Objetivo
Visualizar dados rapidamente.
import pandas as pd
import matplotlib.pyplot as plt

dados = {
    "tipo": ["phishing", "ransomware", "phishing", "vazamento"],
}
df = pd.DataFrame(dados)

df["tipo"].value_counts().plot(kind="bar")
plt.title("Incidentes por Tipo")
plt.show()
NIST: P√≥s-Incidente / M√©tricas / Relat√≥rios.
________________________________________
18	Exerc√≠cio 11 ‚Äì Gera√ß√£o de Relat√≥rio Autom√°tico (TXT)
incidentes = [
    {"tipo": "phishing", "severidade": "M√âDIO"},
    {"tipo": "ransomware", "severidade": "CR√çTICO"},
]

with open("relatorio.txt", "w") as f:
    for i in incidentes:
        f.write(f"{i['tipo']} - {i['severidade']}\n")

